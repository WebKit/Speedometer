+ set -e
+ echo 'Current Dart SDK version'
Current Dart SDK version
+ dart --version
Dart SDK version: 3.9.0-333.0.dev (dev) (Fri Jul 11 09:03:09 2025 -0700) on "macos_arm64"
+ echo 'Fetching dependencies'
Fetching dependencies
+ dart pub get
Resolving dependencies...
Downloading packages...
  _fe_analyzer_shared 82.0.0 (85.0.0 available)
  analyzer 7.4.5 (7.5.7 available)
  analyzer_plugin 0.13.1 (0.13.4 available)
  dds 4.2.7 (5.0.4 available)
  devtools_shared 10.0.2 (12.0.0 available)
  dtd 2.5.1 (4.0.0 available)
  dwds 24.3.5 (24.4.0 available)
  json_rpc_2 3.0.3 (4.0.0 available)
  mime 1.0.6 (2.0.0 available)
  shelf_web_socket 2.0.1 (3.0.0 available)
  vm_service 14.3.1 (15.0.2 available)
  webdev 3.7.1 (3.7.2 available)
Got dependencies!
12 packages have newer versions incompatible with dependency constraints.
Try `dart pub outdated` for more information.
+ echo 'Building dart2js version in -O4'
Building dart2js version in -O4
+ rm -rf build dist/out-dart2js-O4
+ dart run jaspr_cli:jaspr build -O4 --extra-js-compiler-option=--disable-program-split
Building jaspr for client rendering mode.
⠋ Building web assets......⠙ Building web assets...... (1ms)✓ Completed building web assets. (11.8s)
Completed building project to /build/jaspr.
+ mkdir -p dist/out-dart2js-O4
+ cp build/jaspr/index.html build/jaspr/base.css build/jaspr/index.css build/jaspr/favicon.ico build/jaspr/main.dart.js dist/out-dart2js-O4
+ echo 'Building dart2js version in -O4'
Building dart2js version in -O4
+ rm -rf build dist/out-dart2wasm-O2
+ dart run jaspr_cli:jaspr build -O2 --experimental-wasm
Building jaspr for client rendering mode.
⠋ Building web assets......⠙ Building web assets...... (1ms)✓ Completed building web assets. (12.4s)
Completed building project to /build/jaspr.
+ mkdir -p dist/out-dart2wasm-O2
+ cp build/jaspr/index.html build/jaspr/base.css build/jaspr/index.css build/jaspr/favicon.ico build/jaspr/main.dart.js build/jaspr/main.mjs build/jaspr/main.wasm dist/out-dart2wasm-O2
